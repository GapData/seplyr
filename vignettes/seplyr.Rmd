---
title: "seplr"
author: "John Mount"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{seplr}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


This document describe the [`R`](https://www.r-project.org) package [`seplyr`](https://github.com/WinVector/seplyr) which supplies *s*tandard *e*valuation interfaces for some common [`dplyr`](https://CRAN.R-project.org/package=dplyr) verbs.

The idea is this package lets you program over `dplyr` 0.7.* without needing a Ph.D. in computer science.

In `dplyr` if you know the names of columns when you are writing code you can write code such as the following.

```{r ex1a}
suppressPackageStartupMessages(library("dplyr"))

datasets::mtcars %>% 
  group_by(cyl, gear) %>% 
  head()
```

If instead the names of the columns are coming from a variable set elsewhere you need to use a tool to substitute those names in as show below.

```{r ex1b}
groupingVars <- c('cyl', 'gear') # assume this is set elsewhere

datasets::mtcars %>% 
  group_by(!!!rlang::syms(groupingVars)) %>% 
  head()
```

If you don't want to try and digest entire theory of quasi-quoting (the `rlang::syms()`) and splicing (the `!!!`) then you can use `seplyr` which conveniently wraps the operations as follows:

```{r ex1c}
library("seplyr")

datasets::mtcars %>% 
  group_by_se(groupingVars) %>% 
  head()
```

And that is it.  `seplyr::group_by_se()` performs the wrapping for you without you having to work through the details of `rlang`.  If you are interested in the details `sepyr` itself is a good tutorial.  For example you can examine `seplyr`'s implementation to see the necessary notations:

```{r pex1d}
print(group_by_se)
```

And of course we try to supply some usable help entries, example `help(group_by_se)`:

```
group_by standard interface.

Description

 Group a data frame by the groupingVars. Author: John Mount, Win-Vector LLC.

Usage

 group_by_se(.data, groupingVars, add = FALSE)
 
Arguments

 .data	data.frame
 groupingVars	character vector of column names to group by.
 add	logical, passed to group_by
 
Value

 .data grouped by columns named in groupingVars

Examples

 group_by_se(datasets::mtcars, c("cyl", "gear")) %>%
   head()
 # roughly equivalent to:
 # do.call(group_by_, c(list(datasets::mtcars), c('cyl', 'gear')))
```

In addition to a series of adapters we also supply a number of useful new verbs including:

 * `add_group_indices()` Adds a column of per-group ids to data.
 * `add_group_summaries()` Adds per-group summaries to data.
 * `group_summarize()` Binds grouping, arrangement, and summarization together for clear documentation of intent.

**********

One (advanced) caveat is that `seplyr` is an `R` package that declares a dependency on `dplyr` and few other packages. If you are working with normal in-memory data the following should not matter.

I *think* this means that `seplyr` is always calling the `dplyr` version of verbs even if another package (such as `sparklyr` or `dbplyr`) has attempted to override them.  So to use `seplyr` adaptions with such overrides in place one may have to `base::source()` all of the `*.R` files in `seplyr/R` instead of loading the package.

`seplyr` is designed to be a thin package that passes all work to `dplyr`.  If you want a package that works around `dplyr` implementation differences on different data sources I suggest trying our own [`replyr`]( https://CRAN.R-project.org/package=replyr) package.
